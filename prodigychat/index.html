<!DOCTYPE html>
<html>
<body>

<h2 id="bla1">ProdigyGame Leaderboard Test</h2>
<p id="bla2">shhh dont tell anyone</p>
<form id="login">
  <label for="fname">Username:</label><br>
  <input type="text" id="username" name="username" value=""><br>
  <label for="lname">Password:</label><br>
  <input type="text" id="password" name="password" value=""><br><br>
<input type="button" id="clickem" onclick="loadAccount()" value="Login">
</form> 

<p id="login_failed"></p>
<p id="leadywin"></p>
<p id="leadylose"></p>
<script>
function wait(ms){
   var start = new Date().getTime();
   var end = start;
   while(end < start + ms) {
     end = new Date().getTime();
  }
}
LeaderboardLose = 0
LeaderboardWin = 0
var xhttp = new XMLHttpRequest();
function loadAccount() {
document.getElementById('clickem').remove()
document.getElementById('bla1').remove()
document.getElementById('bla2').remove()
document.getElementById("login_failed").innerHTML = "Logging in...";
var login_success = false;
username = document.getElementById("username").value;
password = document.getElementById("password").value;
  xhttp.open("GET", "https://api.prodigygame.com/game-api/status", false);
  xhttp.send();
  ServerData = JSON.parse(xhttp.responseText);
document.getElementById("login_failed").innerHTML = "Loaded server status!";
xhttp.open("GET", "https://cdn.prodigygame.com/game/data/dev/data.json", false);
  xhttp.send();
  GameData = JSON.parse(xhttp.responseText);
document.getElementById("login_failed").innerHTML = "Loaded game data!";

xhttp.open("POST", "https://api.prodigygame.com/game-auth-api/v1/login", false);
 xhttp.setRequestHeader("Content-type", "application/json"); xhttp.send(JSON.stringify({"username":username,"password":password,"clientVersion":ServerData.data.gameClientVersion}));
 User = JSON.parse(xhttp.responseText);
if (User.statusCode == 401)
{
login_success=false
}
else
{
login_success=true
}
if(login_success == false)
{
    document.getElementById("login_failed").innerHTML = "Login Failed.";
}
else
{
document.getElementById("login_failed").innerHTML = "Loaded account!";
xhttp.open("GET", "https://api.prodigygame.com/game-api/v2/characters/"+User.userID, false);
  xhttp.send();
  Appearance = JSON.parse(xhttp.responseText);
document.getElementById("login_failed").innerHTML = "Loaded appearance!";
xhttp.open("GET", "https://api.prodigygame.com/leaderboard-api/user/"+User.userID+"/init?userID="+User.userID, false);
 xhttp.setRequestHeader("authorization", "Bearer "+User.token)
xhttp.send();
Leaderboard = JSON.parse(xhttp.responseText);
 document.getElementById("login_failed").innerHTML = "Loaded Leaderboard! Time to get loopy!";
StartLeaderHax()
document.getElementById("login_failed").innerHTML = "The loop reactivates every minute and 5 seconds, and should work if you open a new tab."
}
  };

// Send text to all users through the server
function sendText() {
  // Construct a msg object containing the data the server needs to process the message from the chat client.
  var msg = ["message",{"action":"wizardcord","data":{"message":document.getElementById("text").value,"date":Date.now(),"userID":53794692}}]

  // Send the msg object as a JSON-formatted string.
  exampleSocket.send(JSON.stringify(msg));
  
  // Blank the text input element, ready to receive the next line of text from the user.
  document.getElementById("text").value = "";
} 

exampleSocket.onmessage = function(event) {
var msg = JSON.parse(event.data);
}

function StartLeaderHax() {
xhttp.open("POST", "https://api.prodigygame.com/leaderboard-api/season/"+Leaderboard.seasonID+"/user/53794692/pvp?userID="+User.userID, true);
xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
 xhttp.setRequestHeader("authorization", "Bearer "+User.token)
xhttp.send("seasonID="+Leaderboard.seasonID+"&action=win");

if (xhttp.responseText = undefined)
{
document.getElementById("login_failed").innerHTML = "Leaderboard sending failed.";
LeaderboardLose = LeaderboardLose + 1
 document.getElementById("leadylose").innerHTML = "Failed Attempts = "+LeaderboardLose;
}
else
{
document.getElementById("login_failed").innerHTML = "Leaderboard sending success!";
LeaderboardWin = LeaderboardWin + 1
document.getElementById("leadywin").innerHTML = "Successful Attempts = "+LeaderboardWin;
}
setTimeout(function(){ StartLeaderHax(); }, 65000)
}


</script>
<style>
#chatty_input {
  width: 100%;
}
	</style>
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
</body>
</html>
